---
layout: post
title: 'PHP: Отлаживаем скрипты командной строки на удаленной машине'
date: 2018-04-01 16:17:32.000000000 +03:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Разработка
- HowTo
tags:
- php
- phpstorm
- xdebug
meta:
  _wpcom_is_markdown: '1'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _publicize_job_id: '16350221816'
  timeline_notification: '1522588660'
author:
  login: russianpenguin
  email: maksim.v.zubkov@gmail.com
  display_name: russianpenguin
  first_name: Maksim
  last_name: Zubkov
permalink: "/2018/04/01/php-%d0%be%d1%82%d0%bb%d0%b0%d0%b6%d0%b8%d0%b2%d0%b0%d0%b5%d0%bc-%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d1%8b-%d0%ba%d0%be%d0%bc%d0%b0%d0%bd%d0%b4%d0%bd%d0%be%d0%b9-%d1%81%d1%82%d1%80%d0%be%d0%ba%d0%b8/"
excerpt: Отлаживать бэкенд-составляющую проектов не составляет труда, но что делать
  когда требуется отлаживать консольные скрипты?
---
<p><img class=" size-full wp-image-2407 alignleft" src="{{ site.baseurl }}/assets/images/2018/04/01-d0bfd180d0b5d0b2d18cd18e.png" alt="01-Превью" width="281" height="143" />Отладка бекенда на PHP уже ни у кого не вызывает проблем: достаточно правильно настроить расширение <a href="https://xdebug.org/">xdebug</a> (или <a href="https://www.jetbrains.com/help/phpstorm/configuring-zend-debugger.html">zend debugger</a>), поставить  <a href="https://chrome.google.com/webstore/detail/xdebug-helper/eadndfjplgieldjbigjakmdgkmoaaaoc?hl=ru">расширение</a> в свой браузер и можно отлаживать, трассировать или профилировать бекенд.</p>
<p>Но что делать, когда нам требуется отладить консольную утилиту на удаленном сервере? В браузере выбрать пункте enable xdebug нельзя, а если у нас и получится передать IDE_KEY, то оно не знает, где располагается среда разработки и куда делать connect_back.</p>
<p>Это все легко решается одним маленьким скриптом (Важно сделать замечание: это будет работать только когда мы подключены по SSH).</p>
<p>[code lang='shell']#!/usr/bin/env bash<br />
IP=`echo $SSH_CLIENT | awk "{print $1}"​`<br />
PHP='/usr/bin/php -d 'xdebug.remote_host=${IP}' -d 'xdebug.remote_autostart=1''<br />
$PHP $@[/code]</p>
<p>Теперь достаточно скомандовать</p>
<p>[code lang="shell"]$ php-debug.sh yii[/code]</p>
<p>И на рабочей машине мы сразу увидим запрос на подключение.</p>
<p><img class="alignnone size-full wp-image-2408" src="{{ site.baseurl }}/assets/images/2018/04/02-d0b7d0b0d0bfd180d0bed181-d0bdd0b0-d0bdd0b0d181d182d180d0bed0b9d0bad183-d0bfd183d182d0b5d0b9.png" alt="02-Запрос на настройку путей" width="706" height="684" /></p>
