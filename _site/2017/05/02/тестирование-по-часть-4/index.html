<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="yandex-verification" content="551ffc5ae1433df6" />
    
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Часть 4: Подготовка окружение (vagrant + PuPHPet) (Тестирование ПО) | Чтобы не забыть</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Часть 4: Подготовка окружение (vagrant + PuPHPet) (Тестирование ПО)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="В этой статье мы подготовим окружение на базе операционной системы Linux с использованием таких инструментов как vagrant и puppet. В этом окружении будет развернут проект на базе yii2 для последующей работы." />
<meta property="og:description" content="В этой статье мы подготовим окружение на базе операционной системы Linux с использованием таких инструментов как vagrant и puppet. В этом окружении будет развернут проект на базе yii2 для последующей работы." />
<link rel="canonical" href="http://localhost:4000/2017/05/02/%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE-%D1%87%D0%B0%D1%81%D1%82%D1%8C-4/" />
<meta property="og:url" content="http://localhost:4000/2017/05/02/%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE-%D1%87%D0%B0%D1%81%D1%82%D1%8C-4/" />
<meta property="og:site_name" content="Чтобы не забыть" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-02T21:04:54+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Часть 4: Подготовка окружение (vagrant + PuPHPet) (Тестирование ПО)" />
<script type="application/ld+json">
{"url":"http://localhost:4000/2017/05/02/%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE-%D1%87%D0%B0%D1%81%D1%82%D1%8C-4/","description":"В этой статье мы подготовим окружение на базе операционной системы Linux с использованием таких инструментов как vagrant и puppet. В этом окружении будет развернут проект на базе yii2 для последующей работы.","headline":"Часть 4: Подготовка окружение (vagrant + PuPHPet) (Тестирование ПО)","dateModified":"2017-05-02T21:04:54+03:00","datePublished":"2017-05-02T21:04:54+03:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2017/05/02/%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE-%D1%87%D0%B0%D1%81%D1%82%D1%8C-4/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css?v=d85e6f1917405784d52928d499ab3e51b4bffcc9">
  </head>
  <body>
    <header class="page-header" role="banner">
      <h1 class="project-name">Часть 4: Подготовка окружение (vagrant + PuPHPet) (Тестирование ПО)</h1>
      <h2 class="project-tagline">Записная книжка рассеянного [в пространстве и времени] программиста</h2>
      
        <a href="https://github.com/RussianPenguin/russianpenguin.github.io" class="btn">View on GitHub</a>
      
      
    </header>

    <main id="content" class="main-content" role="main">
      <h1>Часть 4: Подготовка окружение (vagrant + PuPHPet) (Тестирование ПО)</h1>
<p>02 May 2017</p>

<h2 id="оглавление"><img src="/assets/images/2017/05/d181d0bdd0b8d0bcd0bed0ba-d18dd0bad180d0b0d0bdd0b0-d0bed182-2017-05-02-16-36-41.png?w=300" alt="Снимок экрана от 2017-05-02 16-36-41" /><a href="http://russianpenguin.ru/%d1%82%d0%b5%d1%81%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be/">Оглавление</a></h2>

<p>Это очередная часть проекта <a href="http://russianpenguin.ru/%d1%82%d0%b5%d1%81%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be/">Тестирование ПО</a> который рассказывает о разработке веб-приложений с использованием методологии TDD. Конкретно  в этой главе мы развернем рабочее окружение и создадим шаблон проекта для последующей разработки.</p>

<p>Для создания окружения многие используют для этого ту же машину на которой и пишут код. Нельзя однозначно сказать, хорошо это или плохо. В нашем случае это плохо. Поскольку рабочая система засоряется пакетами и приложениями, которые нужны лишь на один раз. Плюс к этому нельзя взять окружение, удалить его и начать заново если что-то не понравилось или из-за игры с настройками все пошло не так. И конечно же, не стоит забывать разработчиков, которые пользуются отличными от *nix операционными системами, так как многие из дальнейших операций будут им попросту либо недоступны, либо доступны со множеством ограничений.</p>

<p>В этой статье мы подготовим стартовое окружение при помощи инструмента <a href="https://puphpet.com">PuPHPet</a> и дальше немного его доработаем для того, чтобы автоматизировать развертывание проекта из репозитория.</p>

<!--more-->

<h2 id="что-нам-потребуется">Что нам потребуется</h2>

<p>Увы, без сторонних инструментов нам не обойтись. Но их не так много и поставить пакет в вашем любимом дистрибутиве или запустить инсталлятор под windows проблем не составит.</p>

<ol>
  <li><a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> - виртуальная машина от Oracle, которая поставляется под различные операционные системы.</li>
  <li><a href="https://www.vagrantup.com/downloads.html">Vagrant</a> - набор инструментов для простого и удобного создания и настройки виртуальных машин. Этот проект так же поставляется под различные операционные системы.</li>
</ol>

<p>За сведениями про установку данного по вам стоит обратиться к документации вашего дистрибутива или в официальную документацию проектов.</p>

<h2 id="что-мы-сделаем">Что мы сделаем</h2>

<ul>
  <li>сервер nginx (не только проксирование запросов на php-fpm, но и отдача клиенту статики)</li>
  <li>php-fpm (основной инструмент для запуска приложения. Этот механизм быстрее и проще в конфигурировании нежели связка apache+mod_php)</li>
  <li>redis (в приложении, которое мы напишем это будет важное звено)</li>
  <li>memcached (сессии php)</li>
  <li>приложение разделено на две части (бекенд и фронтенд) за основу взять шаблон <a href="https://github.com/yiisoft/yii2-app-advanced">yii2 advanced application template</a>. Для каждой части отдельное доменное имя - tdd.dev для основной компоненты проекта и api.tdd.dev для обработки входящих ajax.</li>
  <li>для каждого из доменов nginx должен быть настроен таким образом чтобы статика запрашивалась непосредственно из папки с содержимым доступным через web, а все скрипты запрашивались через обращение к php-fpm</li>
  <li>база данных mariadb с созданной базой и отдельны пользователем для этой базы</li>
</ul>

<h2 id="веб-конфигуратор">Веб-конфигуратор</h2>

<p>Для начала переходим на главную страницу <a href="https://puphpet.com/">PuPHPet</a> и следуя из раздела в раздел по кнопкам мастера внизу экрана проставляем нужные нам параметры. Процесс конфигурирования интуитивен. Параметры по-умолчанию нас чаще всего будет устраивать, но в некоторых случаях придется сделать исключение и провести предварительную доработку.</p>

<h3 id="deploy-target-locally">Deploy target-&gt;Locally</h3>

<p><img src="/assets/images/2017/05/01-deployment-target.png" alt="01 - Deployment target" />Запуск проекта осуществляется локально через при помощи virtualbox. Устанавливаем <em>locally</em> и операционную систему <em>centos 7</em> (в тестовом примере это x64, но вы всегда можете собрать машину на другой архитектуре и системе, но тогда последующие шаги придется адаптировать под вашу сборку). Другие <strong>Deploy target</strong> отключаем</p>

<p>Для корректной синхронизации между машинами указываем в подразделе <strong>shared folders-&gt;folder target</strong> каталог <em>/var/www</em>. И тип синхронизации <em>Default</em>. <strong>Memory</strong> - <em>1024</em>.</p>

<h3 id="system-packages">System-&gt;Packages</h3>

<p><img src="/assets/images/2017/05/02-system.png" alt="02 - System" />PuPHPet не имеет в своем конфигураторе способа поставить memcached одной галочкой и его надо добавить в список стандартных пакетов.</p>

<ul>
  <li>htop, vim, memcached.</li>
</ul>

<h3 id="system-localetimezone">System-&gt;Locale/Timezone</h3>

<p><img src="/assets/images/2017/05/03-locale.png" alt="03 - Locale" />Для нас будет удобно если локаль системы соответствует региональным установкам.</p>

<ul>
  <li><strong>Default locale</strong> : <em>ru_RU.UTF-8</em></li>
  <li><strong>Supported locales</strong> : <em>ru_RU.UTF-8, en_GB-UTF-8, en_US.UTF-8</em></li>
</ul>

<h3 id="webservers-nginx">Webservers-&gt;Nginx</h3>

<p>Для работы потребуется два домена tdd.dev и api.tdd.dev с практически идентичными конфигурациями.</p>

<h4 id="tdddev">tdd.dev</h4>

<p>[gallery ids=”1901,1905” type=”rectangular” link=”file”]</p>

<ul>
  <li><strong>Project root</strong> : <em>/var/www/frontend/web</em></li>
  <li><strong>Server aliases</strong> : <em>www.tdd.dev</em></li>
</ul>

<p>Домен содержит два локейшна:</p>

<ul>
  <li><strong>location match</strong> : <em>~ .php$</em>
    <ul>
      <li><strong>location root</strong> : <em>/var/www/frontend/web</em></li>
      <li><strong>FastCGI Pass</strong> : <em>127.0.0.1:9000</em></li>
      <li><strong>FastCGI Split Path Info</strong> : <em>^(.+.php)(.*)$</em></li>
      <li><strong>Set variables</strong> : <em>$path_info $fastcgi_path_info</em></li>
      <li><strong>FastCGI Index</strong> : <em>index.php</em></li>
      <li><strong>Try Files</strong> : <em>$uri, =404</em></li>
      <li><strong>FastCGI Environment Variables</strong> : <em>YII_ENV dev, YII_DEBUG 1, SCRIPT_FILENAME $document_root$fastcgi_script_name</em></li>
    </ul>
  </li>
  <li><strong>location match</strong> : <em>/</em>
    <ul>
      <li><strong>location root</strong> : <em>/var/www/frontend/web</em></li>
      <li><strong>Try Files</strong> : <em>$uri, $uri/, /index.php$is_args$args</em></li>
    </ul>
  </li>
</ul>

<h4 id="apitdddev">api.tdd.dev</h4>

<p>[gallery ids=”1914,1917” type=”rectangular” link=”file”]</p>

<ul>
  <li><strong>Project root</strong> : <em>/var/www/backend/web</em></li>
</ul>

<p>Аналогично фронтенду домен также содержит два локейшна.</p>

<ul>
  <li><strong>location match</strong> : <em>~ .php$</em>
    <ul>
      <li><strong>location root</strong> : <em>/var/www/backend/web</em></li>
      <li><strong>FastCGI Pass</strong> : <em>127.0.0.1:9000</em></li>
      <li><strong>FastCGI Split Path Info</strong> : <em>^(.+.php)(.*)$</em></li>
      <li><strong>Set variables</strong> : <em>$path_info $fastcgi_path_info</em></li>
      <li><strong>FastCGI Index</strong> : <em>index.php</em></li>
      <li><strong>Try Files</strong> : <em>$uri, =404</em></li>
      <li><strong>FastCGI Environment Variables</strong> : <em>YII_ENV dev, YII_DEBUG 1, SCRIPT_FILENAME $document_root$fastcgi_script_name</em></li>
    </ul>
  </li>
  <li><strong>location match</strong> : <em>/</em>
    <ul>
      <li><strong>location root</strong> : <em>/var/www/backend/web</em></li>
      <li><strong>Try Files</strong> : <em>$uri, $uri/, /index.php$is_args$args</em></li>
    </ul>
  </li>
</ul>

<p>Стоит отметить, что <em>YII_ENV</em> указывать крайне желательно. Этот параметр в дальнейшем влияет на режим работы Yii2 (либо он будет в отладочном, либо в тестовом, либо в продакшн режиме). Желательным является указание переменной <em>YII_DEBUG</em>.</p>

<h3 id="languages-php">Languages-&gt;PHP</h3>

<p>[gallery ids=”1938,1939” type=”rectangular” link=”file”]</p>

<ul>
  <li><strong>PHP modules</strong> : <em>cli, intl, xml, mbstring, bz2, calendar, ctype, gd, imagick, memcached</em></li>
  <li><strong>Ini Settings</strong> : добавляем еще одну настройку <em>expose_php = 0</em></li>
</ul>

<p>Включаем composer и xdebug. Настройки по-умолчанию нас пока устраивают.</p>

<h3 id="databases-mariadb">Databases-&gt;MariaDB</h3>

<p>[gallery ids=”1946,1947” type=”rectangular” link=”file”]</p>

<ul>
  <li><strong>Root password</strong> : указываем то, что нам нравится. В дальнейшем root нам будет нужен очень редко.</li>
</ul>

<p>В секции пользователей удаляем всех и добавляем нового пользователя tdd. Соответственно указываем для него пароль.</p>

<p>В секции баз данных нам нужна только одна база - tdd. Удаляем все, что там есть и добавляем новую базу.</p>

<p>В секции grants нужно добавить права для пользователя tdd</p>

<ul>
  <li><strong>Privileges</strong> : <em>USAGE</em>, <strong>database</strong> : <em>*.*</em>, <strong>user</strong> : <em>tdd</em></li>
  <li><strong>Privileges</strong> : <em>ALL</em>, <strong>database</strong> : <em>tdd.*</em>, <strong>user</strong> : <em>tdd</em></li>
</ul>

<p>Отмечу, что это не совсем правильный подход. В реальном мире пользователь для администрирования базы должен быть отдельным. Один пользователь для работы с данными и администрирования сделан исключительно для упрощения.</p>

<h3 id="databases-redis">Databases-&gt;Redis</h3>

<p><img src="/assets/images/2017/05/12-redis.png" alt="12 - redis" /></p>

<p>Включаем.</p>

<h2 id="доработка-конфигурации-для-удобной-работы">Доработка конфигурации для удобной работы</h2>

<p>Скачиваем и распаковываем архив из раздела <strong>create archive</strong> в папку с проектами на диске.</p>

<p>Перед запуском нужно отредактировать файл puphpet/puppet/modules/php/manifests/pecl/module.pp. Требуется заменить все вхождения</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"pecl info ${name}"
</code></pre></div></div>

<p>на</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"pecl info ${name} | iconv -c; test \${PIPESTATUS[0]} -eq 0"
</code></pre></div></div>

<p>Это требуется для того, чтобы избавиться от <a href="https://github.com/puphpet/puphpet/issues/2650">бага</a>.</p>

<p>Увы, но это не все. Для удобной работы нам потребуется сделать еще несколько шагов чтобы подготовить инфраструктуру.</p>

<h3 id="токены-авторизации-для-composer">Токены авторизации для composer</h3>

<p>Для настройки токенов нам потребуется сформировать файл auth.json в котором будет размещен ключ авторизации. Чтобы получить ключ открываем страницу <a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a> создаем ключ и копируем то, что получилось.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>  
 <span class="dl">"</span><span class="s2">github-oauth</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>  
 <span class="dl">"</span><span class="s2">github.com</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">тут токен, который получили выше</span><span class="dl">"</span>

<span class="p">}</span>  
<span class="p">}</span>
</code></pre></div></div>

<p>Полученный файл размещаем по адресу <em>puphpet/files/dot/.config/composer/auth.json</em>.</p>

<p>После этапа провизии этот файл будет автоматически скопирован на виртуальную машину.</p>

<p><strong>Предупреждение: не забудьте добавить его в .gitignore перед коммитом.</strong></p>

<h4 id="vagrant">Vagrant</h4>

<p>Создадим файл puphpet/bootstrap.sh со следующим содержимым</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash  </span>
<span class="nb">echo</span> <span class="s2">"export YII</span><span class="se">\_</span><span class="s2">ENV=</span><span class="k">${</span><span class="nv">YII</span><span class="p">\_ENV</span><span class="k">}</span><span class="s2">"</span> <span class="se">\&gt;</span> /etc/profile.d/yii<span class="se">\_</span>env.sh  
<span class="nb">echo</span> <span class="s2">"set YII</span><span class="se">\_</span><span class="s2">ENV=dev</span><span class="k">${</span><span class="nv">YII</span><span class="p">\_ENV</span><span class="k">}</span><span class="s2">"</span> <span class="se">\&gt;</span> /etc/profile.d/yii<span class="se">\_</span>env.csh  
<span class="nb">echo</span> <span class="s2">"export YII</span><span class="se">\_</span><span class="s2">DEBUG=</span><span class="k">${</span><span class="nv">YII</span><span class="p">\_DEBUG</span><span class="k">}</span><span class="s2">"</span> <span class="se">\&gt;</span> /etc/profile.d/yii<span class="se">\_</span>debug.sh  
<span class="nb">echo</span> <span class="s2">"set YII</span><span class="se">\_</span><span class="s2">DEBUG=</span><span class="k">${</span><span class="nv">YII</span><span class="p">\_DEBUG</span><span class="k">}</span><span class="s2">"</span> <span class="se">\&gt;</span> /etc/profile.d/yii<span class="se">\_</span>debug.csh
</code></pre></div></div>

<p>А в Vagrantfile исправляем пару строк</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Vagrant.configure('2') do |config|  
 config.vm.provision 'shell' do |s|  
 s.path = "#{dir}/puphpet/bootstrap.sh"  
 s.env = { YII\_ENV: "dev", YII\_DEBUG: 1 }  
 end  
 eval File.read("#{dir}/puphpet/vagrant/Vagrantfile-#{data['target']}")  
end
</code></pre></div></div>

<p>Тем самым мы заставляем систему прописать нужные переменные окружения до выполнения puppet-apply.</p>

<h4 id="yii2">Yii2</h4>

<p>В каталоге puphpet/files/exec-once-unprivileged размещаем файл <strong>00-composer.sh</strong>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash  </span>
composer global require <span class="s2">"fxp/composer-asset-plugin:^1.3.1"</span>
</code></pre></div></div>

<p>Запустившись однократно команда установит глобально пакет, который нам нужен в дальнейшем для управления статическими пакетами. Файл empty можно удалить из текущего каталога.</p>

<p>В каталоге puphpet/files/exec-always-unprivileged разместим два файла.</p>

<p><strong>Важно: имена файлов сделаны такими не просто так. Скрипт провизии перед выполнением сортирует их в лексикографическом порядке. И очень важно, чтобы инициализация composer выполнялась после развертывания конфигурационных файлов.</strong></p>

<p><strong>00-update-config.sh</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash  </span>
<span class="nb">echo</span> <span class="s2">"Deploy config files"</span>  
su - <span class="nv">$USER</span> <span class="nt">-c</span> <span class="s2">"cd /var/www &amp;&amp; php init --env=</span><span class="k">${</span><span class="nv">YII</span><span class="p">\_ENV</span><span class="k">}</span><span class="s2"> --overwrite=y"</span>
</code></pre></div></div>

<p><strong>99-build.sh</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash  </span>
<span class="nb">echo</span> <span class="s2">"Deploy application"</span>  
<span class="nv">COMPOSER</span><span class="o">=</span>composer  
COMPOSER<span class="se">\_</span><span class="nv">OPT</span><span class="o">=</span><span class="s2">""</span>  
<span class="k">if</span> <span class="o">[</span><span class="s2">"</span><span class="nv">$YII</span><span class="se">\_</span><span class="s2">ENV"</span> <span class="o">=</span> <span class="s2">"prod"</span><span class="o">]</span><span class="p">;</span> <span class="k">then  
 </span>COMPOSER<span class="se">\_</span><span class="nv">OPT</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">COMPOSER</span><span class="p">\_OPT</span><span class="k">}</span><span class="s2"> --no-dev"</span>  
<span class="k">fi  
if</span> <span class="o">[</span><span class="s2">"</span><span class="nv">$YII</span><span class="se">\_</span><span class="s2">DEbUG"</span> <span class="o">=</span> 1] <span class="o">||</span> <span class="o">[</span><span class="s2">"</span><span class="nv">$YII</span><span class="se">\_</span><span class="s2">DEBUG"</span> <span class="o">=</span> <span class="nb">true</span><span class="o">]</span><span class="p">;</span> <span class="k">then  
 </span>COMPOSER<span class="se">\_</span><span class="nv">OPT</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">COMPOSER</span><span class="p">\_OPT</span><span class="k">}</span><span class="s2"> -a"</span>  
<span class="k">fi  
</span>su - <span class="nv">$USER</span> <span class="nt">-c</span> <span class="s2">"cd /var/www &amp;&amp; </span><span class="k">${</span><span class="nv">COMPOSER</span><span class="k">}</span><span class="s2"> install </span><span class="k">${</span><span class="nv">COMPOSER</span><span class="p">\_OPT</span><span class="k">}</span><span class="s2">"</span>
</code></pre></div></div>

<p><strong>Примечание</strong> : во время провизии машины при первом старте у пользователя vagrant набор групп только прописан. И поэтому чтобы они задействованы нужно выполнять команды под su.</p>

<p>Так как проект основывается на шаблоне <a href="https://github.com/yiisoft/yii2-app-advanced">yii2-app-advanced</a>, то просто копируем весь шаблон приложения в каталог с проектом. Конечно же папку <strong>vagrant</strong> и <strong>Vagrantfile</strong> не копируем так как они у нас уже есть.</p>

<p>Из мелких доработок шаблона:</p>

<ul>
  <li>исправим в <strong>environment/index.php</strong> имена окружений на <em>dev</em> и <em>prod</em> вместо оригинальных</li>
  <li>переместим файл requirements.php в каталог environments/dev/frontend/web попутно исправив в нем <em>$frameworkPath</em>. Подключение будет идти из <em>dirname(__FILE__) . ‘/../../vendor/yiisoft/yii2’</em></li>
  <li>В файле <strong>frontend/web/.gitignore</strong> добавим <em>requirements.php</em> в список игнорируемых</li>
  <li>объединить <strong>.gitignore</strong> обоих проектов (того, что сгенерировал PuPHPet и шаблона yii2</li>
</ul>

<h2 id="доработка-хост-системы">Доработка хост-системы</h2>

<p>Для того, чтобы вы смогли открывать получившийся проект в браузере нужно как-то сообщить операционной системе адрес системы с новым проектом.</p>

<p>Самый простой способ - добавить нужные записи в файл <strong>/etc/hosts</strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>192.168.56.101 tdd.dev www.tdd.dev api.tdd.dev
</code></pre></div></div>

<h2 id="запуск">Запуск</h2>

<p><img src="/assets/images/2017/05/13-yii.png" alt="13 - yii" /></p>

<p>На этом доработка закончена и можно делать vagrant up в каталоге проекта. После того, как система соберется вы сможете попасть на готовый проект <a href="http://tdd.dev">http://tdd.dev</a>.</p>

<p><img src="/assets/images/2017/05/14-requirements.png" alt="14 - requirements" /></p>

<p>Чтобы проверить, что все в порядке в dev-режиме предусмотрен скрипт requirements.php. Обратиться к нему можно по адресу <a href="http://tdd.dev/requirements.php">http://tdd.dev/requirements.php</a> и убедиться, что все работает и поиграться с виртуальной машиной.</p>

<h2 id="литература">Литература</h2>

<ol>
  <li><a href="http://codingbee.net/tutorials/puppet/puppet-facts">Puppet – Facts</a></li>
  <li><a href="https://docs.puppet.com/facter/3.6/custom_facts.html">Puppet: Custom facts walkthrough</a></li>
  <li><a href="https://confluence.jetbrains.com/display/PhpStorm/Working+with+Advanced+Vagrant+features+in+PhpStorm">Working with Advanced Vagrant features in PhpStorm</a></li>
  <li><a href="http://www.ozon.ru/context/detail/id/138584016/?partner=russianpenguin&amp;from=bar">“Learning Puppet 4: A Guide to Configuration Management and Automation” Jo Rhett, ISBN: 9781491907665</a></li>
</ol>

<h2 id="исходный-код">Исходный код</h2>

<ul>
  <li><a href="https://github.com/RussianPenguin/TDD_yii2_app/releases/tag/v0.0.1">Исходный код проекта для четвертой части на GitHub</a></li>
</ul>

<h2 id="оглавление-1"><a href="http://russianpenguin.ru/%d1%82%d0%b5%d1%81%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be/">Оглавление</a></h2>



      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="https://github.com/RussianPenguin/russianpenguin.github.io">russianpenguin.github.io</a> is maintained by <a href="https://github.com/RussianPenguin">RussianPenguin</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(69889387, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/69889387" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
  </body>
</html>
