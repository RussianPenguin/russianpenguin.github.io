<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="yandex-verification" content="551ffc5ae1433df6" />
    
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Symfony2, Doctrine2, Postgresql и кодировки | Чтобы не забыть</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Symfony2, Doctrine2, Postgresql и кодировки" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Суть проблемы: в doctrine2 нет возможности выбрать кодировку подключения для драйвера pdo_pgsql. Совсем никак. Нет. Даже не пытайтесь. У вас ничего не получится. Вот незадача: в mysql есть опция драйвера pdo PDO::MYSQL_ATTR_INIT_COMMAND. Благодаря этой опции можно устанавливать кодировку подключения при помощи set names &#39;utf8&#39; И даже драйвер mysql поддерживает установку кодировки при помощи опции charset в настройках подключения. Если мы покопаемся в файле драйвера, то увидим, что кодировка исправно обрабатывается \&lt;b\&gt;Doctrine\DBAL\Driver\PDOMySql\Driver\&lt;/b\&gt; /\*\* \* Constructs the MySql PDO DSN. \* \* @param array $params \* \* @return string The DSN. \*/ private function \_constructPdoDsn(array $params) { $dsn = &#39;mysql:&#39;; if (isset($params[&#39;host&#39;]) &amp;&amp; $params[&#39;host&#39;] != &#39;&#39;) { $dsn .= &#39;host=&#39; . $params[&#39;host&#39;] . &#39;;&#39;; } if (isset($params[&#39;port&#39;])) { $dsn .= &#39;port=&#39; . $params[&#39;port&#39;] . &#39;;&#39;; } if (isset($params[&#39;dbname&#39;])) { $dsn .= &#39;dbname=&#39; . $params[&#39;dbname&#39;] . &#39;;&#39;; } if (isset($params[&#39;unix\_socket&#39;])) { $dsn .= &#39;unix\_socket=&#39; . $params[&#39;unix\_socket&#39;] . &#39;;&#39;; } if (isset($params[&#39;charset&#39;])) { $dsn .= &#39;charset=&#39; . $params[&#39;charset&#39;] . &#39;;&#39;; } return $dsn; } Для драйвера pdo_pgsql (Doctrine\DBAL\Driver\PDOPgSql\Driver) нет ничего подобного. При этом сам драйвер вполне успешно с кодировками работает. Однако, безвыходных ситуаций не бывает. Чтобы как-то изменить кодировку при работе с базой pgsql можно применять события symfony2. А конкретно событие postConnect из doctrine2. Все, что нам потребуется - это реализовать собственный листенер этого события. namespace DatabaseBundle\Event\Listeners; use Doctrine\DBAL\Event\ConnectionEventArgs; use Doctrine\DBAL\Events; use Doctrine\Common\EventSubscriber; /\*\* \* Событие инициализации подключения pgsql. \* Позволяет установить кодировку бд. \*/ class PgsqlConnectionInit implements EventSubscriber { /\*\* \* Используемая кодировка \* \* @var string \*/ private $\_charset; /\*\* \* Конфигурирование кодировки при создании класса \* \* @param string $charset The charset. \*/ public function \_\_construct($charset = &#39;utf8&#39;) { $this-\&gt;\_charset = $charset; } /\*\* \* @param \Doctrine\DBAL\Event\ConnectionEventArgs $args \* \* @return void \*/ public function postConnect(ConnectionEventArgs $args) { $args-\&gt;getConnection()-\&gt;executeQuery(&quot;SET NAMES ?&quot;, array($this-\&gt;\_charset)); } /\*\* \* {@inheritdoc} \*/ public function getSubscribedEvents() { return array(Events::postConnect); } } А затем подключить этот эвент в config.yml services: pgsql.connection.init: class: DatabaseBundle\Event\Listeners\PgsqlConnectionInit tags: - { name: doctrine.event\_listener, event: postConnect } Теперь все ок :)" />
<meta property="og:description" content="Суть проблемы: в doctrine2 нет возможности выбрать кодировку подключения для драйвера pdo_pgsql. Совсем никак. Нет. Даже не пытайтесь. У вас ничего не получится. Вот незадача: в mysql есть опция драйвера pdo PDO::MYSQL_ATTR_INIT_COMMAND. Благодаря этой опции можно устанавливать кодировку подключения при помощи set names &#39;utf8&#39; И даже драйвер mysql поддерживает установку кодировки при помощи опции charset в настройках подключения. Если мы покопаемся в файле драйвера, то увидим, что кодировка исправно обрабатывается \&lt;b\&gt;Doctrine\DBAL\Driver\PDOMySql\Driver\&lt;/b\&gt; /\*\* \* Constructs the MySql PDO DSN. \* \* @param array $params \* \* @return string The DSN. \*/ private function \_constructPdoDsn(array $params) { $dsn = &#39;mysql:&#39;; if (isset($params[&#39;host&#39;]) &amp;&amp; $params[&#39;host&#39;] != &#39;&#39;) { $dsn .= &#39;host=&#39; . $params[&#39;host&#39;] . &#39;;&#39;; } if (isset($params[&#39;port&#39;])) { $dsn .= &#39;port=&#39; . $params[&#39;port&#39;] . &#39;;&#39;; } if (isset($params[&#39;dbname&#39;])) { $dsn .= &#39;dbname=&#39; . $params[&#39;dbname&#39;] . &#39;;&#39;; } if (isset($params[&#39;unix\_socket&#39;])) { $dsn .= &#39;unix\_socket=&#39; . $params[&#39;unix\_socket&#39;] . &#39;;&#39;; } if (isset($params[&#39;charset&#39;])) { $dsn .= &#39;charset=&#39; . $params[&#39;charset&#39;] . &#39;;&#39;; } return $dsn; } Для драйвера pdo_pgsql (Doctrine\DBAL\Driver\PDOPgSql\Driver) нет ничего подобного. При этом сам драйвер вполне успешно с кодировками работает. Однако, безвыходных ситуаций не бывает. Чтобы как-то изменить кодировку при работе с базой pgsql можно применять события symfony2. А конкретно событие postConnect из doctrine2. Все, что нам потребуется - это реализовать собственный листенер этого события. namespace DatabaseBundle\Event\Listeners; use Doctrine\DBAL\Event\ConnectionEventArgs; use Doctrine\DBAL\Events; use Doctrine\Common\EventSubscriber; /\*\* \* Событие инициализации подключения pgsql. \* Позволяет установить кодировку бд. \*/ class PgsqlConnectionInit implements EventSubscriber { /\*\* \* Используемая кодировка \* \* @var string \*/ private $\_charset; /\*\* \* Конфигурирование кодировки при создании класса \* \* @param string $charset The charset. \*/ public function \_\_construct($charset = &#39;utf8&#39;) { $this-\&gt;\_charset = $charset; } /\*\* \* @param \Doctrine\DBAL\Event\ConnectionEventArgs $args \* \* @return void \*/ public function postConnect(ConnectionEventArgs $args) { $args-\&gt;getConnection()-\&gt;executeQuery(&quot;SET NAMES ?&quot;, array($this-\&gt;\_charset)); } /\*\* \* {@inheritdoc} \*/ public function getSubscribedEvents() { return array(Events::postConnect); } } А затем подключить этот эвент в config.yml services: pgsql.connection.init: class: DatabaseBundle\Event\Listeners\PgsqlConnectionInit tags: - { name: doctrine.event\_listener, event: postConnect } Теперь все ок :)" />
<link rel="canonical" href="http://localhost:4000/2015/06/15/symfony2-doctrine2-postgresql-%D0%B8-%D0%BA%D0%BE%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8/" />
<meta property="og:url" content="http://localhost:4000/2015/06/15/symfony2-doctrine2-postgresql-%D0%B8-%D0%BA%D0%BE%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8/" />
<meta property="og:site_name" content="Чтобы не забыть" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-06-15T18:19:52+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Symfony2, Doctrine2, Postgresql и кодировки" />
<script type="application/ld+json">
{"headline":"Symfony2, Doctrine2, Postgresql и кодировки","dateModified":"2015-06-15T18:19:52+03:00","datePublished":"2015-06-15T18:19:52+03:00","description":"Суть проблемы: в doctrine2 нет возможности выбрать кодировку подключения для драйвера pdo_pgsql. Совсем никак. Нет. Даже не пытайтесь. У вас ничего не получится. Вот незадача: в mysql есть опция драйвера pdo PDO::MYSQL_ATTR_INIT_COMMAND. Благодаря этой опции можно устанавливать кодировку подключения при помощи set names &#39;utf8&#39; И даже драйвер mysql поддерживает установку кодировки при помощи опции charset в настройках подключения. Если мы покопаемся в файле драйвера, то увидим, что кодировка исправно обрабатывается \\&lt;b\\&gt;Doctrine\\DBAL\\Driver\\PDOMySql\\Driver\\&lt;/b\\&gt; /\\*\\* \\* Constructs the MySql PDO DSN. \\* \\* @param array $params \\* \\* @return string The DSN. \\*/ private function \\_constructPdoDsn(array $params) { $dsn = &#39;mysql:&#39;; if (isset($params[&#39;host&#39;]) &amp;&amp; $params[&#39;host&#39;] != &#39;&#39;) { $dsn .= &#39;host=&#39; . $params[&#39;host&#39;] . &#39;;&#39;; } if (isset($params[&#39;port&#39;])) { $dsn .= &#39;port=&#39; . $params[&#39;port&#39;] . &#39;;&#39;; } if (isset($params[&#39;dbname&#39;])) { $dsn .= &#39;dbname=&#39; . $params[&#39;dbname&#39;] . &#39;;&#39;; } if (isset($params[&#39;unix\\_socket&#39;])) { $dsn .= &#39;unix\\_socket=&#39; . $params[&#39;unix\\_socket&#39;] . &#39;;&#39;; } if (isset($params[&#39;charset&#39;])) { $dsn .= &#39;charset=&#39; . $params[&#39;charset&#39;] . &#39;;&#39;; } return $dsn; } Для драйвера pdo_pgsql (Doctrine\\DBAL\\Driver\\PDOPgSql\\Driver) нет ничего подобного. При этом сам драйвер вполне успешно с кодировками работает. Однако, безвыходных ситуаций не бывает. Чтобы как-то изменить кодировку при работе с базой pgsql можно применять события symfony2. А конкретно событие postConnect из doctrine2. Все, что нам потребуется - это реализовать собственный листенер этого события. namespace DatabaseBundle\\Event\\Listeners; use Doctrine\\DBAL\\Event\\ConnectionEventArgs; use Doctrine\\DBAL\\Events; use Doctrine\\Common\\EventSubscriber; /\\*\\* \\* Событие инициализации подключения pgsql. \\* Позволяет установить кодировку бд. \\*/ class PgsqlConnectionInit implements EventSubscriber { /\\*\\* \\* Используемая кодировка \\* \\* @var string \\*/ private $\\_charset; /\\*\\* \\* Конфигурирование кодировки при создании класса \\* \\* @param string $charset The charset. \\*/ public function \\_\\_construct($charset = &#39;utf8&#39;) { $this-\\&gt;\\_charset = $charset; } /\\*\\* \\* @param \\Doctrine\\DBAL\\Event\\ConnectionEventArgs $args \\* \\* @return void \\*/ public function postConnect(ConnectionEventArgs $args) { $args-\\&gt;getConnection()-\\&gt;executeQuery(&quot;SET NAMES ?&quot;, array($this-\\&gt;\\_charset)); } /\\*\\* \\* {@inheritdoc} \\*/ public function getSubscribedEvents() { return array(Events::postConnect); } } А затем подключить этот эвент в config.yml services: pgsql.connection.init: class: DatabaseBundle\\Event\\Listeners\\PgsqlConnectionInit tags: - { name: doctrine.event\\_listener, event: postConnect } Теперь все ок :)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2015/06/15/symfony2-doctrine2-postgresql-%D0%B8-%D0%BA%D0%BE%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8/"},"@type":"BlogPosting","url":"http://localhost:4000/2015/06/15/symfony2-doctrine2-postgresql-%D0%B8-%D0%BA%D0%BE%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css?v=eacdde9998fcd3dd17b1956e7070eca69fdaf217">
  </head>
  <body>
    <header class="page-header" role="banner">
      <h1 class="project-name">Symfony2, Doctrine2, Postgresql и кодировки</h1>
      <h2 class="project-tagline">Записная книжка рассеянного [в пространстве и времени] программиста</h2>
      
        <a href="https://github.com/RussianPenguin/russianpenguin.github.io" class="btn">View on GitHub</a>
      
      
    </header>

    <main id="content" class="main-content" role="main">
      <h1>Symfony2, Doctrine2, Postgresql и кодировки</h1>
<p>15 Jun 2015</p>

<p>Суть проблемы: в doctrine2 нет возможности выбрать кодировку подключения для драйвера pdo_pgsql. Совсем никак. Нет. Даже не пытайтесь. У вас ничего не получится.</p>

<p>Вот незадача: в mysql есть опция драйвера pdo <a href="http://php.net/manual/en/ref.pdo-mysql.php">PDO::MYSQL_ATTR_INIT_COMMAND</a>. Благодаря этой опции можно устанавливать кодировку подключения при помощи</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">set</span> <span class="k">names</span> <span class="s1">'utf8'</span>
</code></pre></div></div>

<p>И даже драйвер mysql поддерживает установку кодировки при помощи опции charset в настройках подключения.</p>

<p>Если мы покопаемся в файле драйвера, то увидим, что кодировка исправно обрабатывается</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">\</span><span class="o">&lt;</span><span class="n">b</span><span class="err">\</span><span class="o">&gt;</span><span class="nc">Doctrine\DBAL\Driver\PDOMySql\Driver</span><span class="err">\</span><span class="o">&lt;/</span><span class="n">b</span><span class="err">\</span><span class="o">&gt;</span>

<span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="nc">Constructs</span> <span class="n">the</span> <span class="nc">MySql</span> <span class="no">PDO</span> <span class="no">DSN</span><span class="mf">.</span>  
 <span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="o">@</span><span class="n">param</span> <span class="k">array</span> <span class="nv">$params</span>  
 <span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="o">@</span><span class="k">return</span> <span class="n">string</span> <span class="nc">The</span> <span class="no">DSN</span><span class="mf">.</span>  
 <span class="err">\</span><span class="o">*/</span>  
 <span class="k">private</span> <span class="k">function</span> <span class="err">\</span><span class="nf">_constructPdoDsn</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>  
 <span class="p">{</span>  
 <span class="nv">$dsn</span> <span class="o">=</span> <span class="s1">'mysql:'</span><span class="p">;</span>  
 <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">'host'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>  
 <span class="nv">$dsn</span> <span class="mf">.</span><span class="o">=</span> <span class="s1">'host='</span> <span class="mf">.</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">'host'</span><span class="p">]</span> <span class="mf">.</span> <span class="s1">';'</span><span class="p">;</span>  
 <span class="p">}</span>  
 <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">'port'</span><span class="p">]))</span> <span class="p">{</span>  
 <span class="nv">$dsn</span> <span class="mf">.</span><span class="o">=</span> <span class="s1">'port='</span> <span class="mf">.</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">'port'</span><span class="p">]</span> <span class="mf">.</span> <span class="s1">';'</span><span class="p">;</span>  
 <span class="p">}</span>  
 <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">'dbname'</span><span class="p">]))</span> <span class="p">{</span>  
 <span class="nv">$dsn</span> <span class="mf">.</span><span class="o">=</span> <span class="s1">'dbname='</span> <span class="mf">.</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">'dbname'</span><span class="p">]</span> <span class="mf">.</span> <span class="s1">';'</span><span class="p">;</span>  
 <span class="p">}</span>  
 <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">'unix\_socket'</span><span class="p">]))</span> <span class="p">{</span>  
 <span class="nv">$dsn</span> <span class="mf">.</span><span class="o">=</span> <span class="s1">'unix\_socket='</span> <span class="mf">.</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">'unix\_socket'</span><span class="p">]</span> <span class="mf">.</span> <span class="s1">';'</span><span class="p">;</span>  
 <span class="p">}</span>  
 <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">'charset'</span><span class="p">]))</span> <span class="p">{</span>  
 <span class="nv">$dsn</span> <span class="mf">.</span><span class="o">=</span> <span class="s1">'charset='</span> <span class="mf">.</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">'charset'</span><span class="p">]</span> <span class="mf">.</span> <span class="s1">';'</span><span class="p">;</span>  
 <span class="p">}</span>

<span class="k">return</span> <span class="nv">$dsn</span><span class="p">;</span>  
 <span class="p">}</span>
</code></pre></div></div>

<p>Для драйвера pdo_pgsql (Doctrine\DBAL\Driver\PDOPgSql\Driver) нет ничего подобного.</p>

<p>При этом сам <a href="http://www.postgresql.org/docs/8.4/static/multibyte.html">драйвер</a> вполне успешно с кодировками работает.</p>

<p>Однако, безвыходных ситуаций не бывает. Чтобы как-то изменить кодировку при работе с базой pgsql можно применять <a href="http://symfony.com/doc/current/cookbook/doctrine/event_listeners_subscribers.html">события symfony2</a>. А конкретно событие postConnect из doctrine2.</p>

<p>Все, что нам потребуется - это реализовать собственный листенер этого события.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">DatabaseBundle\Event\Listeners</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Doctrine\DBAL\Event\ConnectionEventArgs</span><span class="p">;</span>  
<span class="kn">use</span> <span class="nc">Doctrine\DBAL\Events</span><span class="p">;</span>  
<span class="kn">use</span> <span class="nc">Doctrine\Common\EventSubscriber</span><span class="p">;</span>

<span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="nc">Событие</span> <span class="n">инициализации</span> <span class="n">подключения</span> <span class="n">pgsql</span><span class="mf">.</span>  
 <span class="err">\</span><span class="o">*</span> <span class="nc">Позволяет</span> <span class="n">установить</span> <span class="n">кодировку</span> <span class="n">бд</span><span class="mf">.</span>  
 <span class="err">\</span><span class="o">*/</span>  
<span class="kd">class</span> <span class="nc">PgsqlConnectionInit</span> <span class="kd">implements</span> <span class="nc">EventSubscriber</span>  
<span class="p">{</span>  
 <span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="nc">Используемая</span> <span class="n">кодировка</span>  
 <span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="o">@</span><span class="k">var</span> <span class="n">string</span>  
 <span class="err">\</span><span class="o">*/</span>  
 <span class="k">private</span> <span class="err">$\</span><span class="n">_charset</span><span class="p">;</span>

<span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="nc">Конфигурирование</span> <span class="n">кодировки</span> <span class="n">при</span> <span class="n">создании</span> <span class="n">класса</span>  
 <span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="o">@</span><span class="n">param</span> <span class="n">string</span> <span class="nv">$charset</span> <span class="nc">The</span> <span class="n">charset</span><span class="mf">.</span>  
 <span class="err">\</span><span class="o">*/</span>  
 <span class="k">public</span> <span class="k">function</span> <span class="err">\</span><span class="nf">_\_construct</span><span class="p">(</span><span class="nv">$charset</span> <span class="o">=</span> <span class="s1">'utf8'</span><span class="p">)</span>  
 <span class="p">{</span>  
 <span class="nv">$this</span><span class="o">-</span><span class="err">\</span><span class="o">&gt;</span><span class="err">\</span><span class="n">_charset</span> <span class="o">=</span> <span class="nv">$charset</span><span class="p">;</span>  
 <span class="p">}</span>

<span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="o">@</span><span class="n">param</span> <span class="err">\</span><span class="nc">Doctrine\DBAL\Event\ConnectionEventArgs</span> <span class="nv">$args</span>  
 <span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="o">@</span><span class="k">return</span> <span class="n">void</span>  
 <span class="err">\</span><span class="o">*/</span>  
 <span class="k">public</span> <span class="k">function</span> <span class="n">postConnect</span><span class="p">(</span><span class="kt">ConnectionEventArgs</span> <span class="nv">$args</span><span class="p">)</span>  
 <span class="p">{</span>  
 <span class="nv">$args</span><span class="o">-</span><span class="err">\</span><span class="o">&gt;</span><span class="nf">getConnection</span><span class="p">()</span><span class="o">-</span><span class="err">\</span><span class="o">&gt;</span><span class="nf">executeQuery</span><span class="p">(</span><span class="s2">"SET NAMES ?"</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="o">-</span><span class="err">\</span><span class="o">&gt;</span><span class="err">\</span><span class="n">_charset</span><span class="p">));</span>  
 <span class="p">}</span>

<span class="o">/</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span>  
 <span class="err">\</span><span class="o">*</span> <span class="p">{</span><span class="o">@</span><span class="n">inheritdoc</span><span class="p">}</span>  
 <span class="err">\</span><span class="o">*/</span>  
 <span class="k">public</span> <span class="k">function</span> <span class="n">getSubscribedEvents</span><span class="p">()</span>  
 <span class="p">{</span>  
 <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nc">Events</span><span class="o">::</span><span class="n">postConnect</span><span class="p">);</span>  
 <span class="p">}</span>  
<span class="p">}</span>


</code></pre></div></div>

<p>А затем подключить этот эвент в config.yml</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:  
 pgsql.connection.init:  
 class: DatabaseBundle\Event\Listeners\PgsqlConnectionInit  
 tags:  
 - { name: doctrine.event\_listener, event: postConnect }
</code></pre></div></div>

<p>Теперь все ок :)</p>




      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="https://github.com/RussianPenguin/russianpenguin.github.io">russianpenguin.github.io</a> is maintained by <a href="https://github.com/RussianPenguin">RussianPenguin</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(69889387, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/69889387" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
  </body>
</html>
