<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="yandex-verification" content="551ffc5ae1433df6" />
    
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Fedora+Nvidia=CUDA | Чтобы не забыть</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Fedora+Nvidia=CUDA" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Итак. Мы хотим получить рабочую инсталляцию на Fedora (в моем случае - RFRemix и с этим связано несколько багов). Для этого нам надо: видеокарту nvidia :) установленный репозитарий cuda (отсюда) заметку о том, как восстановить plymouth после установки драйвером nvidia 1 - Ставим # yum install cuda Этот метапакет поставит все, что должно идти в комплекте (включая свежие дрова) 2 - Удаляем kmod-nvidia Если у вас уже были проинсталены дрова невидии, то нужно удалить имеющийся kmod. Так как он может содержать несовместимую с текущими библиотеками версию модуля # yum remove kmod-nvidia 3 - Пересобираем akmod # akmod -kernel $(uname -r) Тут может потребоваться доставить kernel-headers 4 - Пересобираем initrd Для этого воспользуемся dracut # dracut --force 5 - Ребут :) 6 - Можно собрать семплы Замечу, что делать это надо под рутом или проставив соотвествующие права на папки. Так как мейкфайлы сильно завязаны на относительные пути. # cd /usr/local/cuda-6.5/samples/5\_Simulations/fluidsGL # make 7 - А вот тут нас поджидает облом (RFRemix) \&gt;\&gt;\&gt; WARNING - libGL.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libGLU.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libX11.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libXi.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libXmu.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; Ага! Смотрим в findgllib.mk ifeq (&quot;$(OSLOWER)&quot;,&quot;linux&quot;) # first search lsb\_release DISTRO = $(shell lsb\_release -i -s 2\&gt;/dev/null | tr &quot;[:upper:]&quot; &quot;[:lower:]&quot;) DISTVER = $(shell lsb\_release -r -s 2\&gt;/dev/null) ifeq (&quot;$(DISTRO)&quot;,&quot;&quot;) # second search and parse /etc/issue DISTRO = $(shell more /etc/issue | awk &#39;{print $$1}&#39; | sed &#39;1!d&#39; | sed -e &quot;/^$$/d&quot; 2\&gt;/dev/null | tr &quot;[:upper:]&quot; &quot;[:lower:]&quot;) DISTVER= $(shell more /etc/issue | awk &#39;{print $$2}&#39; | sed &#39;1!d&#39; 2\&gt;/dev/null endif ifeq (&quot;$(DISTRO)&quot;,&quot;&quot;) # third, we can search in /etc/os-release or /etc/{distro}-release DISTRO = $(shell awk &#39;/ID/&#39; /etc/\*-release | sed &#39;s/ID=//&#39; | grep -v &quot;VERSION&quot; | grep -v &quot;ID&quot; | grep -v &quot;DISTRIB&quot;) DISTVER= $(shell awk &#39;/DISTRIB\_RELEASE/&#39; /etc/\*-release | sed &#39;s/DISTRIB\_RELEASE=//&#39; | grep -v &quot;DISTRIB\_RELEASE&quot;) endif endif ifeq (&quot;$(OSUPPER)&quot;,&quot;LINUX&quot;) # $(info) \&gt;\&gt; findgllib.mk -\&gt; LINUX path \&lt;\&lt;\&lt;) # Each set of Linux Distros have different paths for where to find their OpenGL libraries reside UBUNTU\_PKG\_NAME = &quot;nvidia-340&quot; UBUNTU = $(shell echo $(DISTRO) | grep -i ubuntu \&gt;/dev/null 2\&gt;&amp;1; echo $$?) FEDORA = $(shell echo $(DISTRO) | grep -i rfremix \&gt;/dev/null 2\&gt;&amp;1; echo $$?) RHEL = $(shell echo $(DISTRO) | grep -i red \&gt;/dev/null 2\&gt;&amp;1; echo $$?) CENTOS = $(shell echo $(DISTRO) | grep -i centos \&gt;/dev/null 2\&gt;&amp;1; echo $$?) SUSE = $(shell echo $(DISTRO) | grep -i suse \&gt;/dev/null 2\&gt;&amp;1; echo $$?) Еще раз ага! Смотрим как определяется тип дистрибутива. Это команда awk &#39;/ID/&#39; /etc/\*-release | sed &#39;s/ID=//&#39; | grep -v &quot;VERSION&quot; | grep -v &quot;ID&quot; | grep -v &quot;DISTRIB&quot; А у меня она выдает rfremix. А значит такого таргета ни разу нет в списке. :) Ну что делать-то? меняем fedora на rfremix в findgllib.mk и радуемся. Собралось! Но… 8 - А что у нас с библиотеками? $ ./fluidsGL ./fluidsGL: error while loading shared libraries: libcufft.so.6.5: cannot open shared object file: No such file or directory Еще раз. У нас для ldconfig не заданы пути, где лежит libcufft.so.6.5 $ find /usr/ -name libcufft.so.6.5 /usr/local/cuda-6.5/targets/x86\_64-linux/lib/libcufft.so.6.5 $ grep -R /usr/local/cuda-6.5/targets/x86\_64-linux/lib /etc/ld.so.conf.d/ Пусто. # echo &quot;/usr/local/cuda-6.5/targets/x86\_64-linux/lib&quot; \&gt; /etc/ld.so.conf.d/cuda-lib64.conf # ldconfig 9 - Наслаждаемся" />
<meta property="og:description" content="Итак. Мы хотим получить рабочую инсталляцию на Fedora (в моем случае - RFRemix и с этим связано несколько багов). Для этого нам надо: видеокарту nvidia :) установленный репозитарий cuda (отсюда) заметку о том, как восстановить plymouth после установки драйвером nvidia 1 - Ставим # yum install cuda Этот метапакет поставит все, что должно идти в комплекте (включая свежие дрова) 2 - Удаляем kmod-nvidia Если у вас уже были проинсталены дрова невидии, то нужно удалить имеющийся kmod. Так как он может содержать несовместимую с текущими библиотеками версию модуля # yum remove kmod-nvidia 3 - Пересобираем akmod # akmod -kernel $(uname -r) Тут может потребоваться доставить kernel-headers 4 - Пересобираем initrd Для этого воспользуемся dracut # dracut --force 5 - Ребут :) 6 - Можно собрать семплы Замечу, что делать это надо под рутом или проставив соотвествующие права на папки. Так как мейкфайлы сильно завязаны на относительные пути. # cd /usr/local/cuda-6.5/samples/5\_Simulations/fluidsGL # make 7 - А вот тут нас поджидает облом (RFRemix) \&gt;\&gt;\&gt; WARNING - libGL.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libGLU.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libX11.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libXi.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; \&gt;\&gt;\&gt; WARNING - libXmu.so not found, refer to CUDA Samples release notes for how to find and install them. \&lt;\&lt;\&lt; Ага! Смотрим в findgllib.mk ifeq (&quot;$(OSLOWER)&quot;,&quot;linux&quot;) # first search lsb\_release DISTRO = $(shell lsb\_release -i -s 2\&gt;/dev/null | tr &quot;[:upper:]&quot; &quot;[:lower:]&quot;) DISTVER = $(shell lsb\_release -r -s 2\&gt;/dev/null) ifeq (&quot;$(DISTRO)&quot;,&quot;&quot;) # second search and parse /etc/issue DISTRO = $(shell more /etc/issue | awk &#39;{print $$1}&#39; | sed &#39;1!d&#39; | sed -e &quot;/^$$/d&quot; 2\&gt;/dev/null | tr &quot;[:upper:]&quot; &quot;[:lower:]&quot;) DISTVER= $(shell more /etc/issue | awk &#39;{print $$2}&#39; | sed &#39;1!d&#39; 2\&gt;/dev/null endif ifeq (&quot;$(DISTRO)&quot;,&quot;&quot;) # third, we can search in /etc/os-release or /etc/{distro}-release DISTRO = $(shell awk &#39;/ID/&#39; /etc/\*-release | sed &#39;s/ID=//&#39; | grep -v &quot;VERSION&quot; | grep -v &quot;ID&quot; | grep -v &quot;DISTRIB&quot;) DISTVER= $(shell awk &#39;/DISTRIB\_RELEASE/&#39; /etc/\*-release | sed &#39;s/DISTRIB\_RELEASE=//&#39; | grep -v &quot;DISTRIB\_RELEASE&quot;) endif endif ifeq (&quot;$(OSUPPER)&quot;,&quot;LINUX&quot;) # $(info) \&gt;\&gt; findgllib.mk -\&gt; LINUX path \&lt;\&lt;\&lt;) # Each set of Linux Distros have different paths for where to find their OpenGL libraries reside UBUNTU\_PKG\_NAME = &quot;nvidia-340&quot; UBUNTU = $(shell echo $(DISTRO) | grep -i ubuntu \&gt;/dev/null 2\&gt;&amp;1; echo $$?) FEDORA = $(shell echo $(DISTRO) | grep -i rfremix \&gt;/dev/null 2\&gt;&amp;1; echo $$?) RHEL = $(shell echo $(DISTRO) | grep -i red \&gt;/dev/null 2\&gt;&amp;1; echo $$?) CENTOS = $(shell echo $(DISTRO) | grep -i centos \&gt;/dev/null 2\&gt;&amp;1; echo $$?) SUSE = $(shell echo $(DISTRO) | grep -i suse \&gt;/dev/null 2\&gt;&amp;1; echo $$?) Еще раз ага! Смотрим как определяется тип дистрибутива. Это команда awk &#39;/ID/&#39; /etc/\*-release | sed &#39;s/ID=//&#39; | grep -v &quot;VERSION&quot; | grep -v &quot;ID&quot; | grep -v &quot;DISTRIB&quot; А у меня она выдает rfremix. А значит такого таргета ни разу нет в списке. :) Ну что делать-то? меняем fedora на rfremix в findgllib.mk и радуемся. Собралось! Но… 8 - А что у нас с библиотеками? $ ./fluidsGL ./fluidsGL: error while loading shared libraries: libcufft.so.6.5: cannot open shared object file: No such file or directory Еще раз. У нас для ldconfig не заданы пути, где лежит libcufft.so.6.5 $ find /usr/ -name libcufft.so.6.5 /usr/local/cuda-6.5/targets/x86\_64-linux/lib/libcufft.so.6.5 $ grep -R /usr/local/cuda-6.5/targets/x86\_64-linux/lib /etc/ld.so.conf.d/ Пусто. # echo &quot;/usr/local/cuda-6.5/targets/x86\_64-linux/lib&quot; \&gt; /etc/ld.so.conf.d/cuda-lib64.conf # ldconfig 9 - Наслаждаемся" />
<link rel="canonical" href="http://localhost:4000/2014/08/23/fedoranvidiacuda/" />
<meta property="og:url" content="http://localhost:4000/2014/08/23/fedoranvidiacuda/" />
<meta property="og:site_name" content="Чтобы не забыть" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-08-23T18:22:16+04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fedora+Nvidia=CUDA" />
<script type="application/ld+json">
{"url":"http://localhost:4000/2014/08/23/fedoranvidiacuda/","description":"Итак. Мы хотим получить рабочую инсталляцию на Fedora (в моем случае - RFRemix и с этим связано несколько багов). Для этого нам надо: видеокарту nvidia :) установленный репозитарий cuda (отсюда) заметку о том, как восстановить plymouth после установки драйвером nvidia 1 - Ставим # yum install cuda Этот метапакет поставит все, что должно идти в комплекте (включая свежие дрова) 2 - Удаляем kmod-nvidia Если у вас уже были проинсталены дрова невидии, то нужно удалить имеющийся kmod. Так как он может содержать несовместимую с текущими библиотеками версию модуля # yum remove kmod-nvidia 3 - Пересобираем akmod # akmod -kernel $(uname -r) Тут может потребоваться доставить kernel-headers 4 - Пересобираем initrd Для этого воспользуемся dracut # dracut --force 5 - Ребут :) 6 - Можно собрать семплы Замечу, что делать это надо под рутом или проставив соотвествующие права на папки. Так как мейкфайлы сильно завязаны на относительные пути. # cd /usr/local/cuda-6.5/samples/5\\_Simulations/fluidsGL # make 7 - А вот тут нас поджидает облом (RFRemix) \\&gt;\\&gt;\\&gt; WARNING - libGL.so not found, refer to CUDA Samples release notes for how to find and install them. \\&lt;\\&lt;\\&lt; \\&gt;\\&gt;\\&gt; WARNING - libGLU.so not found, refer to CUDA Samples release notes for how to find and install them. \\&lt;\\&lt;\\&lt; \\&gt;\\&gt;\\&gt; WARNING - libX11.so not found, refer to CUDA Samples release notes for how to find and install them. \\&lt;\\&lt;\\&lt; \\&gt;\\&gt;\\&gt; WARNING - libXi.so not found, refer to CUDA Samples release notes for how to find and install them. \\&lt;\\&lt;\\&lt; \\&gt;\\&gt;\\&gt; WARNING - libXmu.so not found, refer to CUDA Samples release notes for how to find and install them. \\&lt;\\&lt;\\&lt; Ага! Смотрим в findgllib.mk ifeq (&quot;$(OSLOWER)&quot;,&quot;linux&quot;) # first search lsb\\_release DISTRO = $(shell lsb\\_release -i -s 2\\&gt;/dev/null | tr &quot;[:upper:]&quot; &quot;[:lower:]&quot;) DISTVER = $(shell lsb\\_release -r -s 2\\&gt;/dev/null) ifeq (&quot;$(DISTRO)&quot;,&quot;&quot;) # second search and parse /etc/issue DISTRO = $(shell more /etc/issue | awk &#39;{print $$1}&#39; | sed &#39;1!d&#39; | sed -e &quot;/^$$/d&quot; 2\\&gt;/dev/null | tr &quot;[:upper:]&quot; &quot;[:lower:]&quot;) DISTVER= $(shell more /etc/issue | awk &#39;{print $$2}&#39; | sed &#39;1!d&#39; 2\\&gt;/dev/null endif ifeq (&quot;$(DISTRO)&quot;,&quot;&quot;) # third, we can search in /etc/os-release or /etc/{distro}-release DISTRO = $(shell awk &#39;/ID/&#39; /etc/\\*-release | sed &#39;s/ID=//&#39; | grep -v &quot;VERSION&quot; | grep -v &quot;ID&quot; | grep -v &quot;DISTRIB&quot;) DISTVER= $(shell awk &#39;/DISTRIB\\_RELEASE/&#39; /etc/\\*-release | sed &#39;s/DISTRIB\\_RELEASE=//&#39; | grep -v &quot;DISTRIB\\_RELEASE&quot;) endif endif ifeq (&quot;$(OSUPPER)&quot;,&quot;LINUX&quot;) # $(info) \\&gt;\\&gt; findgllib.mk -\\&gt; LINUX path \\&lt;\\&lt;\\&lt;) # Each set of Linux Distros have different paths for where to find their OpenGL libraries reside UBUNTU\\_PKG\\_NAME = &quot;nvidia-340&quot; UBUNTU = $(shell echo $(DISTRO) | grep -i ubuntu \\&gt;/dev/null 2\\&gt;&amp;1; echo $$?) FEDORA = $(shell echo $(DISTRO) | grep -i rfremix \\&gt;/dev/null 2\\&gt;&amp;1; echo $$?) RHEL = $(shell echo $(DISTRO) | grep -i red \\&gt;/dev/null 2\\&gt;&amp;1; echo $$?) CENTOS = $(shell echo $(DISTRO) | grep -i centos \\&gt;/dev/null 2\\&gt;&amp;1; echo $$?) SUSE = $(shell echo $(DISTRO) | grep -i suse \\&gt;/dev/null 2\\&gt;&amp;1; echo $$?) Еще раз ага! Смотрим как определяется тип дистрибутива. Это команда awk &#39;/ID/&#39; /etc/\\*-release | sed &#39;s/ID=//&#39; | grep -v &quot;VERSION&quot; | grep -v &quot;ID&quot; | grep -v &quot;DISTRIB&quot; А у меня она выдает rfremix. А значит такого таргета ни разу нет в списке. :) Ну что делать-то? меняем fedora на rfremix в findgllib.mk и радуемся. Собралось! Но… 8 - А что у нас с библиотеками? $ ./fluidsGL ./fluidsGL: error while loading shared libraries: libcufft.so.6.5: cannot open shared object file: No such file or directory Еще раз. У нас для ldconfig не заданы пути, где лежит libcufft.so.6.5 $ find /usr/ -name libcufft.so.6.5 /usr/local/cuda-6.5/targets/x86\\_64-linux/lib/libcufft.so.6.5 $ grep -R /usr/local/cuda-6.5/targets/x86\\_64-linux/lib /etc/ld.so.conf.d/ Пусто. # echo &quot;/usr/local/cuda-6.5/targets/x86\\_64-linux/lib&quot; \\&gt; /etc/ld.so.conf.d/cuda-lib64.conf # ldconfig 9 - Наслаждаемся","headline":"Fedora+Nvidia=CUDA","dateModified":"2014-08-23T18:22:16+04:00","datePublished":"2014-08-23T18:22:16+04:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2014/08/23/fedoranvidiacuda/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css?v=d85e6f1917405784d52928d499ab3e51b4bffcc9">
  </head>
  <body>
    <header class="page-header" role="banner">
      <h1 class="project-name">Fedora+Nvidia=CUDA</h1>
      <h2 class="project-tagline">Записная книжка рассеянного [в пространстве и времени] программиста</h2>
      
        <a href="https://github.com/RussianPenguin/russianpenguin.github.io" class="btn">View on GitHub</a>
      
      
    </header>

    <main id="content" class="main-content" role="main">
      <h1>Fedora+Nvidia=CUDA</h1>
<p>23 Aug 2014</p>

<p>Итак. Мы хотим получить рабочую инсталляцию на Fedora (в моем случае - RFRemix и с этим связано несколько багов).</p>

<p>Для этого нам надо:</p>

<ol>
  <li>видеокарту nvidia :)</li>
  <li>установленный репозитарий cuda (<a href="https://developer.nvidia.com/cuda-downloads" title="CUDA Toolkit downloads">отсюда</a>)</li>
  <li><a href="http://www.if-not-true-then-false.com/2014/fedora-20-nvidia-guide/" title="Fedora 20 nVidia Drivers Install / Uninstall / Restore Plymouth">заметку о том, как восстановить plymouth после установки драйвером nvidia</a></li>
</ol>

<p><strong>1 - Ставим</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># yum install cuda</span>
</code></pre></div></div>

<p>Этот метапакет поставит все, что должно идти в комплекте (включая свежие дрова)</p>

<p><strong>2 - Удаляем kmod-nvidia</strong></p>

<p>Если у вас уже были проинсталены дрова невидии, то нужно удалить имеющийся kmod. Так как он может содержать несовместимую с текущими библиотеками версию модуля</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># yum remove kmod-nvidia</span>
</code></pre></div></div>

<p><strong>3 - Пересобираем akmod</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># akmod -kernel $(uname -r)</span>
</code></pre></div></div>

<p>Тут может потребоваться доставить kernel-headers</p>

<p><strong>4 - Пересобираем initrd</strong></p>

<p>Для этого воспользуемся dracut</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># dracut --force</span>
</code></pre></div></div>

<p><strong>5 - Ребут :)</strong></p>

<p><strong>6 - Можно собрать семплы</strong></p>

<p>Замечу, что делать это надо под рутом или проставив соотвествующие права на папки. Так как мейкфайлы сильно завязаны на относительные пути.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># cd /usr/local/cuda-6.5/samples/5\_Simulations/fluidsGL  </span>
<span class="c"># make</span>
</code></pre></div></div>

<p><strong>7 - А вот тут нас поджидает облом (RFRemix)</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="se">\&gt;\&gt;\&gt;</span> WARNING - libGL.so not found, refer to CUDA Samples release notes <span class="k">for </span>how to find and <span class="nb">install </span>them. <span class="se">\&lt;\&lt;\&lt;</span>  
<span class="se">\&gt;\&gt;\&gt;</span> WARNING - libGLU.so not found, refer to CUDA Samples release notes <span class="k">for </span>how to find and <span class="nb">install </span>them. <span class="se">\&lt;\&lt;\&lt;</span>  
<span class="se">\&gt;\&gt;\&gt;</span> WARNING - libX11.so not found, refer to CUDA Samples release notes <span class="k">for </span>how to find and <span class="nb">install </span>them. <span class="se">\&lt;\&lt;\&lt;</span>  
<span class="se">\&gt;\&gt;\&gt;</span> WARNING - libXi.so not found, refer to CUDA Samples release notes <span class="k">for </span>how to find and <span class="nb">install </span>them. <span class="se">\&lt;\&lt;\&lt;</span>  
<span class="se">\&gt;\&gt;\&gt;</span> WARNING - libXmu.so not found, refer to CUDA Samples release notes <span class="k">for </span>how to find and <span class="nb">install </span>them. <span class="se">\&lt;\&lt;\&lt;</span>
</code></pre></div></div>

<p>Ага!</p>

<p>Смотрим в <em>findgllib.mk</em></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ifeq <span class="o">(</span><span class="s2">"</span><span class="si">$(</span>OSLOWER<span class="si">)</span><span class="s2">"</span>,<span class="s2">"linux"</span><span class="o">)</span>  
 <span class="c"># first search lsb\_release  </span>
 DISTRO <span class="o">=</span> <span class="si">$(</span>shell lsb<span class="se">\_</span>release <span class="nt">-i</span> <span class="nt">-s</span> 2<span class="se">\&gt;</span>/dev/null | <span class="nb">tr</span> <span class="s2">"[:upper:]"</span> <span class="s2">"[:lower:]"</span><span class="si">)</span>  
 DISTVER <span class="o">=</span> <span class="si">$(</span>shell lsb<span class="se">\_</span>release <span class="nt">-r</span> <span class="nt">-s</span> 2<span class="se">\&gt;</span>/dev/null<span class="si">)</span>  
 ifeq <span class="o">(</span><span class="s2">"</span><span class="si">$(</span>DISTRO<span class="si">)</span><span class="s2">"</span>,<span class="s2">""</span><span class="o">)</span>  
 <span class="c"># second search and parse /etc/issue  </span>
 DISTRO <span class="o">=</span> <span class="si">$(</span>shell more /etc/issue | <span class="nb">awk</span> <span class="s1">'{print $$1}'</span> | <span class="nb">sed</span> <span class="s1">'1!d'</span> | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s2">"/^</span><span class="nv">$$</span><span class="s2">/d"</span> 2<span class="se">\&gt;</span>/dev/null | <span class="nb">tr</span> <span class="s2">"[:upper:]"</span> <span class="s2">"[:lower:]"</span><span class="si">)</span>  
 <span class="nv">DISTVER</span><span class="o">=</span> <span class="si">$(</span>shell more /etc/issue | <span class="nb">awk</span> <span class="s1">'{print $$2}'</span> | <span class="nb">sed</span> <span class="s1">'1!d'</span> 2<span class="se">\&gt;</span>/dev/null  
 endif  
 ifeq <span class="o">(</span><span class="s2">"</span><span class="si">$(</span>DISTRO<span class="si">)</span><span class="s2">"</span>,<span class="s2">""</span><span class="o">)</span>  
 <span class="c"># third, we can search in /etc/os-release or /etc/{distro}-release  </span>
 DISTRO <span class="o">=</span> <span class="si">$(</span>shell <span class="nb">awk</span> <span class="s1">'/ID/'</span> /etc/<span class="se">\*</span><span class="nt">-release</span> | <span class="nb">sed</span> <span class="s1">'s/ID=//'</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"VERSION"</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"ID"</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"DISTRIB"</span><span class="si">)</span>  
 <span class="nv">DISTVER</span><span class="o">=</span> <span class="si">$(</span>shell <span class="nb">awk</span> <span class="s1">'/DISTRIB\_RELEASE/'</span> /etc/<span class="se">\*</span><span class="nt">-release</span> | <span class="nb">sed</span> <span class="s1">'s/DISTRIB\_RELEASE=//'</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"DISTRIB</span><span class="se">\_</span><span class="s2">RELEASE"</span><span class="si">)</span>  
 endif  
endif

ifeq <span class="o">(</span><span class="s2">"</span><span class="si">$(</span>OSUPPER<span class="si">)</span><span class="s2">"</span>,<span class="s2">"LINUX"</span><span class="o">)</span>  
 <span class="c"># $(info) \&gt;\&gt; findgllib.mk -\&gt; LINUX path \&lt;\&lt;\&lt;)  </span>
 <span class="c"># Each set of Linux Distros have different paths for where to find their OpenGL libraries reside  </span>
 UBUNTU<span class="se">\_</span>PKG<span class="se">\_</span>NAME <span class="o">=</span> <span class="s2">"nvidia-340"</span>  
 UBUNTU <span class="o">=</span> <span class="si">$(</span>shell <span class="nb">echo</span> <span class="si">$(</span>DISTRO<span class="si">)</span> | <span class="nb">grep</span> <span class="nt">-i</span> ubuntu <span class="se">\&gt;</span>/dev/null 2<span class="se">\&gt;</span>&amp;1<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$$</span>?<span class="si">)</span>  
 FEDORA <span class="o">=</span> <span class="si">$(</span>shell <span class="nb">echo</span> <span class="si">$(</span>DISTRO<span class="si">)</span> | <span class="nb">grep</span> <span class="nt">-i</span> rfremix <span class="se">\&gt;</span>/dev/null 2<span class="se">\&gt;</span>&amp;1<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$$</span>?<span class="si">)</span>  
 RHEL <span class="o">=</span> <span class="si">$(</span>shell <span class="nb">echo</span> <span class="si">$(</span>DISTRO<span class="si">)</span> | <span class="nb">grep</span> <span class="nt">-i</span> red <span class="se">\&gt;</span>/dev/null 2<span class="se">\&gt;</span>&amp;1<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$$</span>?<span class="si">)</span>  
 CENTOS <span class="o">=</span> <span class="si">$(</span>shell <span class="nb">echo</span> <span class="si">$(</span>DISTRO<span class="si">)</span> | <span class="nb">grep</span> <span class="nt">-i</span> centos <span class="se">\&gt;</span>/dev/null 2<span class="se">\&gt;</span>&amp;1<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$$</span>?<span class="si">)</span>  
 SUSE <span class="o">=</span> <span class="si">$(</span>shell <span class="nb">echo</span> <span class="si">$(</span>DISTRO<span class="si">)</span> | <span class="nb">grep</span> <span class="nt">-i</span> suse <span class="se">\&gt;</span>/dev/null 2<span class="se">\&gt;</span>&amp;1<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$$</span>?<span class="si">)</span>
</code></pre></div></div>

<p>Еще раз ага!</p>

<p>Смотрим как определяется тип дистрибутива.</p>

<p>Это команда</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'/ID/'</span> /etc/<span class="se">\*</span><span class="nt">-release</span> | <span class="nb">sed</span> <span class="s1">'s/ID=//'</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"VERSION"</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"ID"</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"DISTRIB"</span>
</code></pre></div></div>

<p>А у меня она выдает <em>rfremix</em>. А значит такого таргета ни разу нет в списке. :)<br />
Ну что делать-то? меняем <em>fedora</em> на <em>rfremix</em> в <em>findgllib.mk</em> и радуемся.<br />
Собралось! Но…</p>

<p><strong>8 - А что у нас с библиотеками?</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./fluidsGL  
./fluidsGL: error <span class="k">while </span>loading shared libraries: libcufft.so.6.5: cannot open shared object file: No such file or directory
</code></pre></div></div>

<p>Еще раз. У нас для ldconfig не заданы пути, где лежит <em>libcufft.so.6.5</em></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>find /usr/ <span class="nt">-name</span> libcufft.so.6.5  
/usr/local/cuda-6.5/targets/x86<span class="se">\_</span>64-linux/lib/libcufft.so.6.5
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-R</span> /usr/local/cuda-6.5/targets/x86<span class="se">\_</span>64-linux/lib /etc/ld.so.conf.d/
</code></pre></div></div>

<p>Пусто.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># echo "/usr/local/cuda-6.5/targets/x86\_64-linux/lib" \&gt; /etc/ld.so.conf.d/cuda-lib64.conf  </span>
<span class="c"># ldconfig</span>
</code></pre></div></div>

<p><strong>9 - Наслаждаемся</strong></p>

<p><a href="https://russianpenguin.files.wordpress.com/2014/08/d0b2d18bd0b4d0b5d0bbd0b5d0bdd0b8d0b5_055.png"><img src="/assets/images/2014/08/d0b2d18bd0b4d0b5d0bbd0b5d0bdd0b8d0b5_055.png?w=300" alt="fluidsGL" /></a></p>




      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="https://github.com/RussianPenguin/russianpenguin.github.io">russianpenguin.github.io</a> is maintained by <a href="https://github.com/RussianPenguin">RussianPenguin</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(69889387, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/69889387" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
  </body>
</html>
